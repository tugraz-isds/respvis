<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
  <title>RespVis - Scatter Plot</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <meta charset="UTF-8"/>
  <link rel="stylesheet" href="../../../respvis.css"/>
  <link rel="stylesheet" href="scatter-continuous.css"/>
</head>
<body>
<h1>Continuous Scatter Plot</h1>
<div id="chart"></div>
<script type="module">
  import {ScatterPlot} from '../../libs/respvis/respvis.js';
  import * as d3 from '../../libs/d3-7.6.0/d3.js'
  import {carData} from "../../data/sold-cars-germany/sold-cars-germany.js";
  import {chooseResponsiveData} from "./chooseResponsiveData.js";

  const allHorsePower = carData.map(entry => entry.hp)
  const allPrices = carData.map(entry => entry.price)
  const allMileages = carData.map(entry => entry.mileage)

  const baseScaleX = d3.scaleLinear()
    .domain([0, Math.max(...allHorsePower)])
    .nice()
  const baseScaleY = d3.scaleLinear()
    .domain([0, Math.max(...allPrices)])
    .nice()
  const colorScale = d3.scaleSequential()
    .domain([0, Math.max(...allMileages)])
    .interpolator(d3.interpolateYlGnBu)

  const calcData = () => {
    return {
      xValues: [allHorsePower],
      xScale: baseScaleX,
      yValues: [allPrices],
      yScale: baseScaleY,
      xAxis: {title: 'Horse Power', subtitle: '[PS]'},
      yAxis: {title: 'Price', subtitle: '[EU]'},
      color: {
        colorDim: allMileages,
        colorScale: colorScale
      },
      legend: {
        title: 'Legend',
        keys: ["Low Mileage", "High Mileage"],
        labels: ["Low Mileage", "High Mileage"]
      },
      zoom: {
        in: 20,
        out: 1
      }
    };
  }

  const chartWindow = d3.select('#chart').append('div')
  const renderer = new ScatterPlot(chartWindow, calcData())
  renderer.addCustomListener('resize.custom', (selection, data) => {
    chooseResponsiveData(document.documentElement, data)
  })
  renderer.buildWindowChart()
</script>
</body>
</html>
