<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
  <title>RespVis - Percent Stacked Bar Chart</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <meta charset="UTF-8"/>
  <link rel="stylesheet" href="../../../respvis.css"/>
  <link rel="stylesheet" href="stacked-bar-percent.css"/>
</head>
<body>
<h1>Percent Stacked Bar Chart</h1>
<div id="chart"></div>
<script type="module">
  import {select} from '../../libs/d3-7.6.0/d3.js';
  import {
    chartWindowBarStackedData,
    chartWindowBarStackedRender,
    chartWindowBarStackedAutoFilterCategories,
    chartWindowBarStackedAutoFilterSubcategories,
    chartWindowBarStackedAutoResize,
  } from '../../libs/respvis/respvis.js';
  import {chooseResponsiveData} from "./chooseResponsiveData.js";

  const calcData = () => {
    return {
      categories: ['A', 'B', 'C'],
      subcategories: ['X', 'Y', 'Z'],
      values: [
        [2, 3, 4],
        [1, 4, 2],
        [2, 1, 3],
      ],
      valuesAsRatios: true,
      xAxis: {title: 'Category'},
      yAxis: {title: 'Percent'},
      legend: {title: 'Subcategories', reverse: true},
      title: "Stacked Bar Chart"
    }
  }

  const chartWindow = select('#chart')
    .append('div')
    .datum(chartWindowBarStackedData(calcData()))
    .call(chartWindowBarStackedRender)
    .call(chartWindowBarStackedAutoResize)
    .call(chartWindowBarStackedAutoFilterCategories())
    .call(chartWindowBarStackedAutoFilterSubcategories())
    .on('resize', function (e, d) {
      chooseResponsiveData(document.documentElement, d)
      chartWindow.datum(chartWindowBarStackedData(d)).call(chartWindowBarStackedRender);
    });
</script>
</body>
</html>
